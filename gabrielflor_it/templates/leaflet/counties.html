<!doctype html>
<html>
    <head>
        <link rel="stylesheet" href="../static/leaflet/leaflet.css" />
        <!--[if lte IE 8]><link rel="stylesheet" href="../static/leaflet/leaflet.ie.css" /><![endif]-->        
        <title>d3 - counties</title>
    </head>
   <body>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js" type="text/javascript"></script>
        <div id="map" style="height: 600px"></div> <!-- width equals available horizontal space by default -->
        <a href="#" id="reload">reload</a>
        <script src="../static/geojson/counties.js"></script>
        <script src="../static/leaflet/leaflet.js"></script>
        <script>

$(function() {

    var map = new L.Map('map');

    var cloudmadeUrl = 'http://{s}.tile.cloudmade.com/0800d770f193426b824ebc0852845f51/998/256/{z}/{x}/{y}.png',
        cloudmadeAttrib = '',
        cloudmade = new L.TileLayer(cloudmadeUrl, {maxZoom: 18, attribution: cloudmadeAttrib});

    var usa = new L.LatLng(39, -96); // geographical point (longitude and latitude)
    map.setView(usa, 4).addLayer(cloudmade);

    var geojsonLayer;

    geojsonLayer = new L.GeoJSON();
    geojsonLayer.on("featureparse", function (e) {
        if (e.layer.setStyle) {
            e.layer.setStyle({
                "stroke": false,
                "color": '#'+(Math.random()*0xFFFFFF<<0).toString(16)
            });
        }
    });
    geojsonLayer.addGeoJSON(counties);
    map.addLayer(geojsonLayer);

    $('#reload').click(function(){

        if (geojsonLayer) {
            map.removeLayer(geojsonLayer);
        }

        geojsonLayer = new L.GeoJSON();
        geojsonLayer.on("featureparse", function (e) {
            if (e.layer.setStyle) {
                e.layer.setStyle({
                    "stroke": false,
                    "color": '#'+(Math.random()*0xFFFFFF<<0).toString(16)
                });
            }
        });
        geojsonLayer.addGeoJSON(counties);
        map.addLayer(geojsonLayer);
        return false;
    });
});
        
        </script>

    </body>
</html>



